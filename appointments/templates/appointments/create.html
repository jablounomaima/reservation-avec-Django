<!-- appointments/templates/appointments/create.html -->

{% extends 'appointments/base.html' %}

{% block content %}
<h2 class="mb-4">üìÖ Prendre un rendez-vous</h2>

<!-- Dans create.html, apr√®s le champ 'pet' -->
{% if form.pet.queryset|length == 0 %}
    <div class="alert alert-info mt-3">
        <p>si Vous n'avez aucun animal enregistr√©.</p>
        <a href="{% url 'appointments:add_pet' %}" class="btn btn-primary btn-sm">‚ûï Ajouter un animal</a>
    </div>
{% endif %}

<!-- Message de reprogrammation -->
{% if original_appointment %}
    <div class="alert alert-warning mb-4">
        <strong>Reprogrammation :</strong> Ce rendez-vous a √©t√© refus√©. Choisissez un nouveau cr√©neau.
    </div>
{% endif %}

<form method="post" class="needs-validation" novalidate>
    {% csrf_token %}

    <!-- Erreurs g√©n√©rales -->
    {% if form.non_field_errors %}
        <div class="alert alert-danger">{{ form.non_field_errors }}</div>
    {% endif %}

    <!-- Champ Animal -->
    <div class="mb-3">
        <label for="{{ form.pet.id_for_label }}" class="form-label">Animal</label>
        {{ form.pet }}
        {% if form.pet.errors %}
            <div class="text-danger">{{ form.pet.errors }}</div>
        {% endif %}
        {% if form.pet.help_text %}
            <small class="text-muted">{{ form.pet.help_text }}</small>
        {% endif %}
    </div>

    <!-- Service -->
    <div class="mb-3">
        <label for="{{ form.service.id_for_label }}" class="form-label">Service</label>
        {{ form.service }}
        {% if form.service.errors %}
            <div class="text-danger">{{ form.service.errors }}</div>
        {% endif %}
    </div>

    <!-- Date -->
    <div class="mb-3">
        <label for="{{ form.date.id_for_label }}" class="form-label">Date</label>
        {{ form.date }}
        {% if form.date.errors %}
            <div class="text-danger">{{ form.date.errors }}</div>
        {% endif %}
    </div>

    <!-- Heure -->
    <div class="mb-3">
        <label for="{{ form.time.id_for_label }}" class="form-label">Heure</label>
        {{ form.time }}
        {% if form.time.errors %}
            <div class="text-danger">{{ form.time.errors }}</div>
        {% endif %}
    </div>

    <!-- T√©l√©phone -->
    <div class="mb-3">
        <label for="{{ form.phone.id_for_label }}" class="form-label">T√©l√©phone</label>
        {{ form.phone }}
        {% if form.phone.errors %}
            <div class="invalid-feedback d-block">
                {% for error in form.phone.errors %}
                    {{ error }}
                {% endfor %}
            </div>
        {% endif %}
        <small class="text-muted">Ex: +212 6 12 34 56 78</small>
    </div>

    <!-- Remarques -->
    <div class="mb-3">
        <label for="{{ form.notes.id_for_label }}" class="form-label">Remarques</label>
        {{ form.notes }}
        {% if form.notes.errors %}
            <div class="text-danger">{{ form.notes.errors }}</div>
        {% endif %}
    </div>

    <!-- Boutons -->
    <div class="mt-4">
        <button type="submit" class="btn btn-primary btn-lg">‚úÖ R√©server</button>
        <a href="{% url 'appointments:appointment_list' %}" class="btn btn-secondary">‚Üê Retour</a>
    </div>
</form>

<!-- Message si pas d'animaux -->
{% if form.pet.queryset|length == 0 %}
    <div class="alert alert-info mt-3">
        Vous n'avez aucun animal enregistr√©. 
        <a href="/admin/appointments/pet/add/" target="_blank">Ajoutez un animal</a> via l'admin.
    </div>
{% endif %}




{% endblock %}